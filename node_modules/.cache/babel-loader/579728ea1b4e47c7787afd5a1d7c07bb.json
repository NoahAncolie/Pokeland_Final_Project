{"ast":null,"code":"import Node from '../core/Node.js';\nimport Object3DNode from '../accessors/Object3DNode.js';\nimport PositionNode from '../accessors/PositionNode.js';\nimport UniformNode from '../core/UniformNode.js';\nimport OperatorNode from '../math/OperatorNode.js';\nimport MathNode from '../math/MathNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { getDistanceAttenuation } from '../functions/BSDFs.js';\nimport { Color } from 'three';\n\nclass LightNode extends Node {\n  constructor() {\n    let light = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    super('vec3');\n    this.updateType = NodeUpdateType.Object;\n    this.light = light;\n    this._colorNode = new UniformNode(new Color());\n    this._lightCutoffDistanceNode = new UniformNode(0);\n    this._lightDecayExponentNode = new UniformNode(0);\n  }\n\n  getHash() {\n    return this.light.uuid;\n  }\n\n  update() {\n    this._colorNode.value.copy(this.light.color).multiplyScalar(this.light.intensity);\n\n    this._lightCutoffDistanceNode.value = this.light.distance;\n    this._lightDecayExponentNode.value = this.light.decay;\n  }\n\n  generate(builder) {\n    const lightPositionView = new Object3DNode(Object3DNode.VIEW_POSITION);\n    const positionView = new PositionNode(PositionNode.VIEW);\n    const lVector = new OperatorNode('-', lightPositionView, positionView);\n    const lightDirection = new MathNode(MathNode.NORMALIZE, lVector);\n    const lightDistance = new MathNode(MathNode.LENGTH, lVector);\n    const lightAttenuation = getDistanceAttenuation({\n      lightDistance,\n      cutoffDistance: this._lightCutoffDistanceNode,\n      decayExponent: this._lightDecayExponentNode\n    });\n    const lightColor = new OperatorNode('*', this._colorNode, lightAttenuation);\n    lightPositionView.object3d = this.light;\n    const lightingModelFunction = builder.context.lightingModel;\n\n    if (lightingModelFunction !== undefined) {\n      const directDiffuse = builder.context.directDiffuse;\n      const directSpecular = builder.context.directSpecular;\n      lightingModelFunction({\n        lightDirection,\n        lightColor,\n        directDiffuse,\n        directSpecular\n      }, builder);\n    }\n  }\n\n}\n\nexport default LightNode;","map":{"version":3,"names":["Node","Object3DNode","PositionNode","UniformNode","OperatorNode","MathNode","NodeUpdateType","getDistanceAttenuation","Color","LightNode","constructor","light","updateType","Object","_colorNode","_lightCutoffDistanceNode","_lightDecayExponentNode","getHash","uuid","update","value","copy","color","multiplyScalar","intensity","distance","decay","generate","builder","lightPositionView","VIEW_POSITION","positionView","VIEW","lVector","lightDirection","NORMALIZE","lightDistance","LENGTH","lightAttenuation","cutoffDistance","decayExponent","lightColor","object3d","lightingModelFunction","context","lightingModel","undefined","directDiffuse","directSpecular"],"sources":["/Users/paolucciloic/Desktop/pokemon-projet-final/Pokeland_Final_Project/node_modules/three-stdlib/nodes/lights/LightNode.js"],"sourcesContent":["import Node from '../core/Node.js';\nimport Object3DNode from '../accessors/Object3DNode.js';\nimport PositionNode from '../accessors/PositionNode.js';\nimport UniformNode from '../core/UniformNode.js';\nimport OperatorNode from '../math/OperatorNode.js';\nimport MathNode from '../math/MathNode.js';\nimport { NodeUpdateType } from '../core/constants.js';\nimport { getDistanceAttenuation } from '../functions/BSDFs.js';\nimport { Color } from 'three';\n\nclass LightNode extends Node {\n  constructor(light = null) {\n    super('vec3');\n    this.updateType = NodeUpdateType.Object;\n    this.light = light;\n    this._colorNode = new UniformNode(new Color());\n    this._lightCutoffDistanceNode = new UniformNode(0);\n    this._lightDecayExponentNode = new UniformNode(0);\n  }\n\n  getHash() {\n    return this.light.uuid;\n  }\n\n  update() {\n    this._colorNode.value.copy(this.light.color).multiplyScalar(this.light.intensity);\n\n    this._lightCutoffDistanceNode.value = this.light.distance;\n    this._lightDecayExponentNode.value = this.light.decay;\n  }\n\n  generate(builder) {\n    const lightPositionView = new Object3DNode(Object3DNode.VIEW_POSITION);\n    const positionView = new PositionNode(PositionNode.VIEW);\n    const lVector = new OperatorNode('-', lightPositionView, positionView);\n    const lightDirection = new MathNode(MathNode.NORMALIZE, lVector);\n    const lightDistance = new MathNode(MathNode.LENGTH, lVector);\n    const lightAttenuation = getDistanceAttenuation({\n      lightDistance,\n      cutoffDistance: this._lightCutoffDistanceNode,\n      decayExponent: this._lightDecayExponentNode\n    });\n    const lightColor = new OperatorNode('*', this._colorNode, lightAttenuation);\n    lightPositionView.object3d = this.light;\n    const lightingModelFunction = builder.context.lightingModel;\n\n    if (lightingModelFunction !== undefined) {\n      const directDiffuse = builder.context.directDiffuse;\n      const directSpecular = builder.context.directSpecular;\n      lightingModelFunction({\n        lightDirection,\n        lightColor,\n        directDiffuse,\n        directSpecular\n      }, builder);\n    }\n  }\n\n}\n\nexport default LightNode;\n"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,iBAAjB;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,YAAP,MAAyB,8BAAzB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,QAAP,MAAqB,qBAArB;AACA,SAASC,cAAT,QAA+B,sBAA/B;AACA,SAASC,sBAAT,QAAuC,uBAAvC;AACA,SAASC,KAAT,QAAsB,OAAtB;;AAEA,MAAMC,SAAN,SAAwBT,IAAxB,CAA6B;EAC3BU,WAAW,GAAe;IAAA,IAAdC,KAAc,uEAAN,IAAM;IACxB,MAAM,MAAN;IACA,KAAKC,UAAL,GAAkBN,cAAc,CAACO,MAAjC;IACA,KAAKF,KAAL,GAAaA,KAAb;IACA,KAAKG,UAAL,GAAkB,IAAIX,WAAJ,CAAgB,IAAIK,KAAJ,EAAhB,CAAlB;IACA,KAAKO,wBAAL,GAAgC,IAAIZ,WAAJ,CAAgB,CAAhB,CAAhC;IACA,KAAKa,uBAAL,GAA+B,IAAIb,WAAJ,CAAgB,CAAhB,CAA/B;EACD;;EAEDc,OAAO,GAAG;IACR,OAAO,KAAKN,KAAL,CAAWO,IAAlB;EACD;;EAEDC,MAAM,GAAG;IACP,KAAKL,UAAL,CAAgBM,KAAhB,CAAsBC,IAAtB,CAA2B,KAAKV,KAAL,CAAWW,KAAtC,EAA6CC,cAA7C,CAA4D,KAAKZ,KAAL,CAAWa,SAAvE;;IAEA,KAAKT,wBAAL,CAA8BK,KAA9B,GAAsC,KAAKT,KAAL,CAAWc,QAAjD;IACA,KAAKT,uBAAL,CAA6BI,KAA7B,GAAqC,KAAKT,KAAL,CAAWe,KAAhD;EACD;;EAEDC,QAAQ,CAACC,OAAD,EAAU;IAChB,MAAMC,iBAAiB,GAAG,IAAI5B,YAAJ,CAAiBA,YAAY,CAAC6B,aAA9B,CAA1B;IACA,MAAMC,YAAY,GAAG,IAAI7B,YAAJ,CAAiBA,YAAY,CAAC8B,IAA9B,CAArB;IACA,MAAMC,OAAO,GAAG,IAAI7B,YAAJ,CAAiB,GAAjB,EAAsByB,iBAAtB,EAAyCE,YAAzC,CAAhB;IACA,MAAMG,cAAc,GAAG,IAAI7B,QAAJ,CAAaA,QAAQ,CAAC8B,SAAtB,EAAiCF,OAAjC,CAAvB;IACA,MAAMG,aAAa,GAAG,IAAI/B,QAAJ,CAAaA,QAAQ,CAACgC,MAAtB,EAA8BJ,OAA9B,CAAtB;IACA,MAAMK,gBAAgB,GAAG/B,sBAAsB,CAAC;MAC9C6B,aAD8C;MAE9CG,cAAc,EAAE,KAAKxB,wBAFyB;MAG9CyB,aAAa,EAAE,KAAKxB;IAH0B,CAAD,CAA/C;IAKA,MAAMyB,UAAU,GAAG,IAAIrC,YAAJ,CAAiB,GAAjB,EAAsB,KAAKU,UAA3B,EAAuCwB,gBAAvC,CAAnB;IACAT,iBAAiB,CAACa,QAAlB,GAA6B,KAAK/B,KAAlC;IACA,MAAMgC,qBAAqB,GAAGf,OAAO,CAACgB,OAAR,CAAgBC,aAA9C;;IAEA,IAAIF,qBAAqB,KAAKG,SAA9B,EAAyC;MACvC,MAAMC,aAAa,GAAGnB,OAAO,CAACgB,OAAR,CAAgBG,aAAtC;MACA,MAAMC,cAAc,GAAGpB,OAAO,CAACgB,OAAR,CAAgBI,cAAvC;MACAL,qBAAqB,CAAC;QACpBT,cADoB;QAEpBO,UAFoB;QAGpBM,aAHoB;QAIpBC;MAJoB,CAAD,EAKlBpB,OALkB,CAArB;IAMD;EACF;;AA9C0B;;AAkD7B,eAAenB,SAAf"},"metadata":{},"sourceType":"module"}